{"version":3,"sources":["Sidebar.js","Projection.js","About.js","Content.js","Layout.js","Data.js","App.js","serviceWorker.js","index.js"],"names":["Sidebar","this","props","setSidebarCanvas","side_canvas","handleSelectAlgorithm","bind","e","v","target","value","selectAlgorithm","_this","_this$props","sidebar_orientation","sidebar_image_size","grem","p","hover_index","mnist_labels","color_array","algorithm_options","algorithm_choice","react_default","a","createElement","style","display","flexDirection","justifyContent","flexGrow","padding","alignItems","onChange","map","option","index","key","ref","width","height","background","concat","join","color","transition","onClick","toggleAbout","Component","mnist_tile_locations","Object","toConsumableArray","Array","n","i","process","mnist_images","src","img","document","Projection","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","handleResize","camera","aspect","updateProjectionMatrix","renderer","setSize","current_scale","getScaleFromZ","position","z","d3_x","x","d3_y","y","resize_transform","d3","translate","scale","view","mount","d3_zoom","transform","state","init","assertThisInitialized","addPoints","setUpCamera","animate","getZFromScale","changeEmbeddings","prev_choice","new_choice","_this2","ranges","start","sprite_side","end","sprite_number","push","embedding_chunks","range","algorithm_embedding_keys","slice","_loop","c","echunk","points","scene","children","numVertices","length","geometry","attributes","array","Float32Array","l","tween","TWEEN","to","easing","Linear","None","onUpdate","THREE","needsUpdate","rvFOV","degToRad","fov","Math","tan","camera_z_position","fov_height","d3_transform","k","set","new_size","input","scale1","domain","clamp","zoomScaler","point_group","material","uniforms","size","camera_z_start","mnist_embeddings","vFOV","xs","min_x","_","max_x","ys","min_y","max_y","max_x_from_center","m","abs","max_y_from_center","far","max","scaleExtent","on","zoomHandler","initial_scale","initial_transform","_this$props2","label_chunks","loader","textures","t","load","flipY","magFilter","lchunk","vertices","embedding","vert","positions","offsets","colors","addAttribute","floor","texture","repeat","vertexShader","fragmentShader","point_cloud","userData","sprite_index","add","hover_container","point","frustumCulled","visible","digit_index","full_index","_this$props3","copyVector3sArray","offset","highlight_container","highlights","remove","apply","mouse_position","_this$props4","sidebar_ctx","mouse_vector","_ref","_ref2","slicedToArray","mouseX","mouseY","mouseToThree","raycaster","setFromCamera","params","Points","threshold","intersects","intersectObjects","intersect","sortIntersectsByDistanceToRay","object","setHoverIndex","highlightPoint","fillRect","drawImage","_this3","domElement","_d3$mouse","node","_d3$mouse2","checkIntersects","_this$props5","setClearColor","appendChild","addBlankHighlightPoints","handleMouse","requestAnimationFrame","render","prevProps","_this$props6","removeChild","_this4","_this$props7","overflow","About","left","top","right","bottom","paddingTop","overflowY","fontSize","lineHeight","className","textAlign","cursor","textDecoration","maxWidth","margin","dist_default","tb","lr","Layout","ww","wh","sidebar_height","show_about","checkHash","indexOf","setState","window","innerWidth","innerHeight","sidebar_mount","offsetHeight","imageSmoothingEnabled","canvas","ctx","getContext","history","pushState","location","pathname","hash","addEventListener","removeEventListener","tsne_mnist_embeddings","md08_umap_mnist_embeddings","_this$state","sidebar_style","main_style","font_size","objectSpread","scaler","general_style","src_Sidebar","src_Projection","src_About","Data","embeddings","fetch","then","response","json","scaled_embeddings","scaleEmbeddings","console","log","src_Layout","assign","App","src_Data","Boolean","hostname","match","ReactDOM","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"sRAuHeA,8LAnHXC,KAAKC,MAAMC,iBAAiBF,KAAKG,aACjCH,KAAKI,sBAAwBJ,KAAKI,sBAAsBC,KAAKL,oDAGzCM,GACpB,IAAIC,EAAID,EAAEE,OAAOC,MACjBT,KAAKC,MAAMS,gBAAgBH,oCAGpB,IAAAI,EAAAX,KAAAY,EAWHZ,KAAKC,MATPY,EAFKD,EAELC,oBACAC,EAHKF,EAGLE,mBACAC,EAJKH,EAILG,KACAC,EALKJ,EAKLI,EACAC,EANKL,EAMLK,YACAC,EAPKN,EAOLM,aACAC,EARKP,EAQLO,YACAC,EATKR,EASLQ,kBACAC,EAVKT,EAULS,iBAGF,OACEC,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLC,QAAS,OACTC,cAAe,SACfC,eAAgB,gBAChBC,SAAU,IAGZP,EAAAC,EAAAC,cAAA,WACG,IACDF,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLK,QAASf,EAAO,EAChBW,QAAS,OACTE,eAAgB,gBAChBG,WAAY,WAGdT,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAAA,UACEQ,SAAUhC,KAAKI,sBACfK,MAAOW,EAAkBC,IAExBD,EAAkBa,IAAI,SAACC,EAAQC,GAAT,OACrBb,EAAAC,EAAAC,cAAA,UAAQY,IAAKF,EAAQzB,MAAOyB,GACzBA,OAKTZ,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLC,QAAS,OACTC,cAC0B,eAAxBd,EAAuC,MAAQ,WAGnDS,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,UACEa,IAAK,SAAAlC,GACHQ,EAAKR,YAAcA,GAErBmC,MAAOxB,EACPyB,OAAQzB,KAGZQ,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEI,SAAU,IACtBP,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLe,WAAYvB,EAAW,OAAAwB,OACZtB,EAAYD,EAAaD,IAAcyB,KAAK,KADhC,KAEnB,cACJC,MAAO1B,EAAc,OAAS,OAC9Ba,QAASd,EAAED,EAAO,EAAGA,EAAO,GAC5BW,QAAS,OACTE,eAAgB,gBAChBgB,WAAY,oBAGdtB,EAAAC,EAAAC,cAAA,qBACCP,EAAcK,EAAAC,EAAAC,cAAA,WAAMN,EAAaD,IAAsB,MAE1DK,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLK,QAASd,EAAED,EAAO,EAAGA,EAAO,GAC5BW,QAAS,OACTE,eAAgB,kBAJpB,SAQGX,EAAcK,EAAAC,EAAAC,cAAA,WAAMP,GAAqB,SAKlDK,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEK,QAASf,EAAO,IAC5BO,EAAAC,EAAAC,cAAA,sEAC2D,IACzDF,EAAAC,EAAAC,cAAA,UACEqB,QAAS,WACPlC,EAAKV,MAAM6C,aAAY,KAF3B,mBAvGUC,0DCalBC,EAAuBC,OAAAC,EAAA,EAAAD,CAAIE,MANX,KAMiClB,IACnD,SAACmB,EAAGC,GAAJ,SAAAZ,OAAaa,iBAAb,KAAAb,OAFsB,qBAEtBA,OAA2DY,EAA3D,UAGEE,EAAeP,EAAqBf,IAAI,SAAAuB,GAC1C,IAAIC,EAAMC,SAASlC,cAAc,OAEjC,OADAiC,EAAID,IAAMA,EACHC,IAyhBME,cAhgBb,SAAAA,EAAY1D,GAAO,IAAAU,EAAA,OAAAsC,OAAAW,EAAA,EAAAX,CAAAjD,KAAA2D,IACjBhD,EAAAsC,OAAAY,EAAA,EAAAZ,CAAAjD,KAAAiD,OAAAa,EAAA,EAAAb,CAAAU,GAAAI,KAAA/D,KAAMC,KA2ER+D,aAAe,SAAC1B,EAAOC,GACrB5B,EAAKsD,OAAOC,OAAS5B,EAAQC,EAC7B5B,EAAKsD,OAAOE,yBACZxD,EAAKyD,SAASC,QAAQ/B,EAAOC,GAC7B,IAAI+B,EAAgB3D,EAAK4D,cAAc5D,EAAKsD,OAAOO,SAASC,GACxDC,GAAS/D,EAAKsD,OAAOO,SAASG,EAAIL,EAAiB3D,EAAKV,MAAMqC,MAAQ,EACtEsC,EAAOjE,EAAKsD,OAAOO,SAASK,EAAIP,EAAgB3D,EAAKV,MAAMsC,OAAS,EACpEuC,EAAmBC,IACpBC,UAAUN,EAAME,GAChBK,MAAMX,GACLY,EAAOH,IAAUpE,EAAKwE,OAC1BxE,EAAKyE,QAAQC,UAAUH,EAAMJ,IArF7BnE,EAAK2E,MAAQ,GACb3E,EAAK4E,KAAO5E,EAAK4E,KAAKlF,KAAV4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACZA,EAAK8E,UAAY9E,EAAK8E,UAAUpF,KAAf4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACjBA,EAAKqD,aAAerD,EAAKqD,aAAa3D,KAAlB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACpBA,EAAK+E,YAAc/E,EAAK+E,YAAYrF,KAAjB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACnBA,EAAKgF,QAAUhF,EAAKgF,QAAQtF,KAAb4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACfA,EAAK4D,cAAgB5D,EAAK4D,cAAclE,KAAnB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACrBA,EAAKiF,cAAgBjF,EAAKiF,cAAcvF,KAAnB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACrBA,EAAKkF,iBAAmBlF,EAAKkF,iBAAiBxF,KAAtB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KAVPA,gFAaFmF,EAAaC,GAI5B,IAJwC,IAAAC,EAAAhG,KAGpCiG,EAAS,GACJ5C,EAAI,EAAGA,EAvDA,GAuDmBA,IAAK,CACtC,IAAI6C,EAzDQC,KAyDA9C,EACR+C,EA1DQD,MA0DD9C,EAAI,GACLgD,KAANhD,IAAyB+C,EAAMC,OACnCJ,EAAOK,KAAK,CAACJ,EAAOE,IAUtB,IAPA,IAAIG,EAAmBN,EAAOhE,IAAI,SAAAuE,GAAK,OACrCR,EAAK/F,MAAM+F,EAAK/F,MAAMwG,yBAAyBV,IAAaW,MAC1DF,EAAM,GACNA,EAAM,MAd8BG,EAAA,SAkB/BC,GAOP,IANA,IAAIC,EAASN,EAAiBK,GAE1BE,EAASd,EAAKe,MAAMC,SAAS,GAAGA,SAASJ,GACzCK,EAAcJ,EAAOK,OACrB1C,EAAWsC,EAAOK,SAASC,WAAW5C,SAAS6C,MAC/C7G,EAAS,IAAI8G,aAA2B,EAAdL,GACrB5D,EAAI,EAAGlB,EAAQ,EAAGoF,EAAIN,EAAa5D,EAAIkE,EAAGlE,IAAKlB,GAAS,EAAG,CAClE,IAAIwC,EAAIkC,EAAOxD,GAAG,GACdwB,EAAIgC,EAAOxD,GAAG,GAElB7C,EAAO2B,GAASwC,EAChBnE,EAAO2B,EAAQ,GAAK0C,EACpBrE,EAAO2B,EAAQ,GAHP,EAMV,IAAIqF,EAAQ,IAAIC,QAAYjD,GACzBkD,GAAGlH,EAAQ,KACXmH,OAAOF,SAAaG,OAAOC,MAC9BL,EAAMM,SAAS,WACbhB,EAAOK,SAASC,WAAW5C,SAAW,IAAIuD,IACxCvD,EACA,GAEFsC,EAAOK,SAASC,WAAW5C,SAASwD,aAAc,IAEpDR,EAAMtB,SA1BCU,EAAI,EAAGA,EArEA,GAqEmBA,IAAKD,EAA/BC,yCA8BG3B,GACZ,IAAIgD,EAAQF,IAAWG,SAASlI,KAAKiE,OAAOkE,KAG5C,OAFmBnI,KAAKC,MAAMsC,OAAS0C,GACC,EAAImD,KAAKC,IAAIJ,EAAQ,0CAIjDK,GACZ,IAAIL,EAAQF,IAAWG,SAASlI,KAAKiE,OAAOkE,KAExCI,EAA+B,GADbH,KAAKC,IAAIJ,EAAQ,GAAKK,GAG5C,OADYtI,KAAKC,MAAMsC,OAASgG,wCAmBhC,IAAIC,EAAezD,IAASM,UAExBJ,EAAQuD,EAAaC,EACrB9D,IAAM6D,EAAa7D,EAAI3E,KAAKC,MAAMqC,MAAQ,GAAK2C,EAC/CJ,GAAK2D,EAAa3D,EAAI7E,KAAKC,MAAMsC,OAAS,GAAK0C,EAC/CR,EAAIzE,KAAK4F,cAAcX,GAE3BjF,KAAKiE,OAAOO,SAASkE,IAAI/D,EAAGE,EAAGJ,GAK/B,IAFA,IAAIkE,EA3HS,SAAAC,GACf,IAAIC,EAAS9D,MAEV+D,OAAO,CAAC,GAAI,IACZtC,MAAM,CAAC,GAAI,KACXuC,OAAM,GACIhE,MAEV+D,OAAO,CAAC,EAAG,KACXtC,MAAM,CAAC,GAAI,KACd,OAAIoC,GAAS,EACJC,EAAOD,GAIP,GA4GQI,CAAWvE,GACtBwE,EAAcjJ,KAAK+G,MAAMC,SAAS,GAAGA,SAChCJ,EAAI,EAAGA,EAAIqC,EAAY/B,OAAQN,IACtCqC,EAAYrC,GAAGsC,SAASC,SAASC,KAAK3I,MAAQkI,wCAIpC,IAsBRU,EAtBQzI,EAC8BZ,KAAKC,MAAzCqC,EADM1B,EACN0B,MAAOC,EADD3B,EACC2B,OAAQ+G,EADT1I,EACS0I,iBAGjBC,GADSvJ,KAAKiE,OAAOC,OACdlE,KAAKiE,OAAOkE,KACnBF,EAAQF,IAAWG,SAASqB,GAE5BC,EAAKF,EAAiBrH,IAAI,SAAA3B,GAAC,OAAIA,EAAE,KACjCmJ,EAAQC,MAAMF,GACdG,EAAQD,MAAMF,GACdI,EAAKN,EAAiBrH,IAAI,SAAA3B,GAAC,OAAIA,EAAE,KACjCuJ,EAAQH,MAAME,GACdE,EAAQJ,MAAME,GAKdG,EAAoBL,MAAM,CAACD,EAAOE,GAAO1H,IAAI,SAAA+H,GAAC,OAAI5B,KAAK6B,IAAID,MAC3DE,EAAoBR,MAAM,CAACG,EAAOC,GAAO7H,IAAI,SAAA+H,GAAC,OAAI5B,KAAK6B,IAAID,MAe3DG,EAAuB,MAF3Bd,EAXiBjB,KAAKgC,IAAIL,EAAmBG,GAWf9B,KAAKC,IAAIJ,EAAQ,IAG/CjI,KAAKiE,OAAOkG,IAAMA,EAClBnK,KAAKiE,OAAOO,SAASC,EAAqB,IAAjB4E,EAGzBrJ,KAAKoF,QAAUL,MAEZsF,YAAY,CAACrK,KAAKuE,cAAc4F,EAAM,GAAInK,KAAKuE,cAAc,MAC7D+F,GAAG,OAAQtK,KAAKuK,YAAYlK,KAAKL,OAEpC,IAAIkF,EAAOH,IAAU/E,KAAKmF,OAC1BnF,KAAKkF,KAAOA,EACZA,EAAKnB,KAAK/D,KAAKoF,SACf,IAAIoF,EAAgBxK,KAAKuE,cAAcvE,KAAKiE,OAAOO,SAASC,GACxDgG,EAAoB1F,IACrBC,UAAU1C,EAAQ,EAAGC,EAAS,GAC9B0C,MAAMuF,GACTxK,KAAKoF,QAAQC,UAAUH,EAAMuF,uCAQ7B,IALU,IAAAC,EAC4C1K,KAAKC,MAArDqJ,EADIoB,EACJpB,iBAAkBpI,EADdwJ,EACcxJ,aAAcC,EAD5BuJ,EAC4BvJ,YAGlC8E,EAAS,GACJ5C,EAAI,EAAGA,EA5MA,GA4MmBA,IAAK,CACtC,IAAI6C,EA9MQC,KA8MA9C,EACR+C,EA/MQD,MA+MD9C,EAAI,GACLgD,KAANhD,IAAyB+C,EAAMC,OACnCJ,EAAOK,KAAK,CAACJ,EAAOE,IAEtB,IAAIG,EAAmBN,EAAOhE,IAAI,SAAAuE,GAAK,OACrC8C,EAAiB5C,MAAMF,EAAM,GAAIA,EAAM,MAErCmE,EAAe1E,EAAOhE,IAAI,SAAAuE,GAAK,OACjCtF,EAAawF,MAAMF,EAAM,GAAIA,EAAM,MAIjCoE,EAAS,IAAI7C,IACjB/H,KAAK6K,SAAW7H,EAAqBf,IAAI,SAAAsF,GACvC,IAAIuD,EAAIF,EAAOG,KAAKxD,GAIpB,OAHAuD,EAAEE,OAAQ,EACVF,EAAEG,UAAYlD,IAEP+C,IAIT,IADA,IAAI7B,EAAc,IAAIlB,IACbnB,EAAI,EAAGA,EApOA,GAoOmBA,IAAK,CAKtC,IAJA,IAAIC,EAASN,EAAiBK,GAC1BsE,EAASP,EAAa/D,GAEtBuE,EAAW,GACN5K,EAAI,EAAGA,EAAIsG,EAAOK,OAAQ3G,IAAK,CACtC,IAAI6K,EAAYvE,EAAOtG,GACnB8K,EAAO,IAAItD,IAAcqD,EAAU,GAAIA,EAAU,GAAI,GACzDD,EAAS5K,GAAK8K,EAGhB,IAAIlE,EAAW,IAAIY,IAEfd,EAAckE,EAASjE,OACvBoE,EAAY,IAAIhE,aAA2B,EAAdL,GAC7BsE,EAAU,IAAIjE,aAA2B,EAAdL,GAC3BuE,EAAS,IAAIlE,aAA2B,EAAdL,GAC9BE,EAASsE,aAAa,WAAY,IAAI1D,IAAsBuD,EAAW,IACvEnE,EAASsE,aAAa,SAAU,IAAI1D,IAAsBwD,EAAS,IACnEpE,EAASsE,aAAa,QAAS,IAAI1D,IAAsByD,EAAQ,IAEjE,IAAK,IAAInI,EAAI,EAAGlB,EAAQ,EAAGoF,EAAIN,EAAa5D,EAAIkE,EAAGlE,IAAKlB,GAAS,EAAG,CAClE,IAAIwC,EAAIkC,EAAOxD,GAAG,GACdwB,EAAIgC,EAAOxD,GAAG,GAElBiI,EAAUnJ,GAASwC,EACnB2G,EAAUnJ,EAAQ,GAAK0C,EACvByG,EAAUnJ,EAAQ,GAHV,EAUV,IAFA,IAESkB,EAAI,EAAGlB,EAAQ,EAAGoF,EAAIN,EAAa5D,EAAIkE,EAAGlE,IAAKlB,GAAS,EAAG,CAClE,IAAIwC,EAAMtB,EAzQA,GAGM,GAEC,KAqQbwB,EAvQY,GAwQbuD,KAAKsD,MAAMrI,EA3QJ,IAKO,KAuQjBkI,EAAQpJ,GAASwC,EACjB4G,EAAQpJ,EAAQ,GAAK0C,EAGvB,IAAK,IAAIxB,EAAI,EAAGlB,EAAQ,EAAGoF,EAAIN,EAAa5D,EAAIkE,EAAGlE,IAAKlB,GAAS,EAAG,CAClE,IAAIQ,EAAQxB,EAAY+J,EAAO7H,IAC/BmI,EAAOrJ,GAASQ,EAAM,GAAK,IAC3B6I,EAAOrJ,EAAQ,GAAKQ,EAAM,GAAK,IAC/B6I,EAAOrJ,EAAQ,GAAKQ,EAAM,GAAK,IAIjC,IAAIwG,EAAW,CACbwC,QAAS,CAAElL,MAAOT,KAAK6K,SAASjE,IAChCgF,OAAQ,CAAEnL,MAAO,IAAIsH,IApBD,EAtQV,GAsQU,EAtQV,KA2RVqB,KAAM,CAAE3I,MAxRQ,KAqTdyI,EAAW,IAAInB,IAAqB,CACtCoB,SAAUA,EACV0C,aA5Be,2WA6BfC,eAhBiB,kYAoBfC,EAAc,IAAIhE,IAAaZ,EAAU+B,GAC7C6C,EAAYC,SAAW,CAAEC,aAAcrF,GAEvCqC,EAAYiD,IAAIH,GAGlB/L,KAAK+G,MAAMmF,IAAIjD,qDAIf,IAAIkD,EAAkB,IAAIpE,IAC1B/H,KAAK+G,MAAMmF,IAAIC,GAEf,IACIhB,EAAW,CADJ,IAAIpD,IAAc,EAAG,EAAG,IAE/BZ,EAAW,IAAIY,IACfd,EAAckE,EAASjE,OACvBoE,EAAY,IAAIhE,aAA2B,EAAdL,GAC7BsE,EAAU,IAAIjE,aAA2B,EAAdL,GAC/BE,EAASsE,aAAa,WAAY,IAAI1D,IAAsBuD,EAAW,IACvEnE,EAASsE,aAAa,SAAU,IAAI1D,IAAsBwD,EAAS,IAGnE,IAGIpC,EAAW,CACbwC,QAAS,CAAElL,MAAOT,KAAK6K,SAAS,IAChCe,OAAQ,CAAEnL,MAAO,IAAIsH,IALD,EAtVR,GAsVQ,EAtVR,KA4VZqB,KAAM,CAAE3I,MAAO,KAyBbyI,EAAW,IAAInB,IAAqB,CACtCoB,SAAUA,EACV0C,aAxBe,mRAyBfC,eAfiB,gVAkBfM,EAAQ,IAAIrE,IAAaZ,EAAU+B,GACvCkD,EAAMC,eAAgB,EAEtBrM,KAAK+G,MAAMC,SAAS,GAAGsF,SAAU,EACjCtM,KAAK+G,MAAMC,SAAS,GAAGkF,IAAIE,0CAGdH,EAAcM,EAAaC,GAAY,IAAAC,EACCzM,KAAKC,MAApDwG,EAD8CgG,EAC9ChG,yBAA0BpF,EADoBoL,EACpBpL,iBAE5B+K,EAAQpM,KAAK+G,MAAMC,SAAS,GAAGA,SAAS,GAExCoE,EAAYpL,KAAKC,MAAMwG,EAAyBpF,IAClDmL,GAIErB,EAAW,CADJ,IAAIpD,IAAcqD,EAAU,GAAIA,EAAU,GAAI,IAGrDG,EAAU,IAAIjE,aAAa,GAE3B3C,EAAM4H,EAhZI,GAgZyB,GAAM,KACzC1H,EAA6C,GAAxCuD,KAAKsD,MAAMa,EAjZN,IAiZyC,KACvDhB,EAAQ,GAAK5G,EACb4G,EAAQ,GAAK1G,EAEbuH,EAAMjF,SAASC,WAAW5C,SAASkI,kBAAkBvB,GACrDiB,EAAMjF,SAASC,WAAW5C,SAASwD,aAAc,EACjDoE,EAAMjF,SAASC,WAAWuF,OAAOtF,MAAQkE,EACzCa,EAAMjF,SAASC,WAAWuF,OAAO3E,aAAc,EAG/CoE,EAAMlD,SAASC,SAASwC,QAAQlL,MAAQT,KAAK6K,SAASoB,8CAItD,IAAIW,EAAsB5M,KAAK+G,MAAMC,SAAS,GAC1C6F,EAAaD,EAAoB5F,SACrC4F,EAAoBE,OAApBC,MAAAH,EAAmB3J,OAAAC,EAAA,EAAAD,CAAW4J,4CAGhBG,GAAgB,IAAAC,EAC2BjN,KAAKC,MAAxDqC,EADwB2K,EACxB3K,MAAOC,EADiB0K,EACjB1K,OAAQ2K,EADSD,EACTC,YAAapM,EADJmM,EACInM,mBAclC,IAAIqM,EAZJ,SAAAC,GAAwC,IAAAC,EAAApK,OAAAqK,EAAA,EAAArK,CAAAmK,EAAA,GAAjBG,EAAiBF,EAAA,GAATG,EAASH,EAAA,GACtC,OAAO,IAAItF,IACRwF,EAASjL,EAAS,EAAI,GACrBkL,EAASjL,EAAU,EAAI,EACzB,GAQekL,CAAaT,GAChChN,KAAK0N,UAAUC,cAAcR,EAAcnN,KAAKiE,QAChDjE,KAAK0N,UAAUE,OAAOC,OAAOC,UAAY,IACzC,IAAIC,EAAa/N,KAAK0N,UAAUM,iBAC9BhO,KAAK+G,MAAMC,SAAS,GAAGA,UAEzB,GAAI+G,EAAW,GAAI,CACjB,IACIE,EAZN,SAAuCF,GACrC,OAAOrE,SAASqE,EAAY,iBAUJG,CAA8BH,GACpB,GAC9B9B,EAAegC,EAAUE,OAAOnC,SAASC,aACzCM,EAAc0B,EAAU9L,MACxBqK,EA7bQrG,KA6bK8F,EAA6BM,EAC9CvM,KAAKC,MAAMmO,cAAc5B,GACzBxM,KAAKqO,eAAepC,EAAcM,EAAaC,GAC/CxM,KAAK+G,MAAMC,SAAS,GAAGsF,SAAU,EAEjCY,EAAYoB,SAAS,EAAG,EAAGxN,EAAoBA,GAC/CoM,EAAYqB,UACVhL,EAAa0I,GAEZM,EAvcS,GAGM,MAqchBnE,KAAKsD,MAAMa,EAxcD,IAGM,MAychB,EACA,EACAzL,EACAA,QAGFd,KAAKC,MAAMmO,cAAc,MACzBpO,KAAK+G,MAAMC,SAAS,GAAGsF,SAAU,EACjCY,EAAYoB,SAAS,EAAG,EAAGxN,EAAoBA,yCAIrC,IAAA0N,EAAAxO,KACRkF,EAAOH,IAAU/E,KAAKoE,SAASqK,YAEnCzO,KAAK0N,UAAY,IAAI3F,IAErB7C,EAAKoF,GAAG,YAAa,WAAM,IAAAoE,EACF3J,IAASG,EAAKyJ,QADZC,EAAA3L,OAAAqK,EAAA,EAAArK,CAAAyL,EAAA,GAErB1B,EAAiB,CAFI4B,EAAA,GAAAA,EAAA,IAGzBJ,EAAKK,gBAAgB7B,oCAIlB,IAAA8B,EACmB9O,KAAKC,MAAvBqC,EADDwM,EACCxM,MAAOC,EADRuM,EACQvM,OAEbvC,KAAK+G,MAAQ,IAAIgB,IAEjB,IACI7D,EAAS5B,EAAQC,EAIrBvC,KAAKiE,OAAS,IAAI8D,IALP,GAKqC7D,EAHrC,IACD,KAIVlE,KAAKoE,SAAW,IAAI2D,IACpB/H,KAAKoE,SAAS2K,cAAc,QAAU,GACtC/O,KAAKoE,SAASC,QAAQ/B,EAAOC,GAC7BvC,KAAKmF,MAAM6J,YAAYhP,KAAKoE,SAASqK,YAErCzO,KAAKyF,YAELzF,KAAKiP,0BAELjP,KAAK0F,cAEL1F,KAAK2F,UAEL3F,KAAKkP,gDAILC,sBAAsBnP,KAAK2F,SAC3B8B,WACAzH,KAAKoE,SAASgL,OAAOpP,KAAK+G,MAAO/G,KAAKiE,oDAItCjE,KAAKuF,kDAGY8J,GAAW,IAAAC,EACJtP,KAAKC,MAAvBqC,EADsBgN,EACtBhN,MAAOC,EADe+M,EACf/M,OACTD,IAAU+M,EAAU/M,OAASC,IAAW8M,EAAU9M,QACpDvC,KAAKgE,aAAa1B,EAAOC,GAEvB8M,EAAUhO,mBAAqBrB,KAAKC,MAAMoB,kBAC5CrB,KAAK6F,iBACHwJ,EAAUhO,iBACVrB,KAAKC,MAAMoB,iEAMfrB,KAAKmF,MAAMoK,YAAYvP,KAAKoE,SAASqK,6CAG9B,IAAAe,EAAAxP,KAAAyP,EACiBzP,KAAKC,MAAvBqC,EADCmN,EACDnN,MAAOC,EADNkN,EACMlN,OACb,OACEjB,EAAAC,EAAAC,cAAA,OACEC,MAAO,CAAEa,MAAOA,EAAOC,OAAQA,EAAQmN,SAAU,UACjDrN,IAAK,SAAA8C,GACHqK,EAAKrK,MAAQA,YA1fEpC,8BCuBV4M,mLAhEJ,IAAAhP,EAAAX,KAAAY,EACWZ,KAAKC,MAAjBc,EADCH,EACDG,KADCH,EACKI,EACZ,OACEM,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACL+C,SAAU,QACVoL,KAAM,EACNC,IAAK,EACLC,MAAO,EACPC,OAAQ,EACRvN,WAAY,OACZG,MAAO,OACPqN,WAAmB,EAAPjP,EACZkP,UAAW,OACXC,SAAU,GACVC,WAAY,MAGd7O,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACLe,WAAY,OACZgC,SAAU,QACVoL,KAAM,EACNC,IAAK,EACLC,MAAO,EACPhO,QAASf,EAAO,IAPpB,QAWEO,EAAAC,EAAAC,cAAA,UACEqB,QAAS,WACPlC,EAAKV,MAAM6C,aAAY,IAEzBsN,UAAU,YACV3O,MAAO,CACL+C,SAAU,WACVsL,MAAO,EACPD,IAAK,EACLtN,OAAe,EAAPxB,EACRuB,MAAc,EAAPvB,EACPe,QAASf,EAAO,EAChBsP,UAAW,SACXC,OAAQ,UACRC,eAAgB,SAdpB,SAoBFjP,EAAAC,EAAAC,cAAA,OACEC,MAAO,CACL+O,SAAiB,GAAPzP,EACV0P,OAAQ,SACR3O,QAASf,EAAO,EAChB4B,MAAO,SAGTrB,EAAAC,EAAAC,cAACkP,EAAAnP,EAAD,KC9DW,yoRDIDwB,aEGpB,SAAS/B,EAAE2P,EAAIC,GACb,SAAAnO,OAAUkO,EAAV,OAAAlO,OAAkBmO,EAAlB,MAGF,IAAIzP,EAAc,CAChB,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,IACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,KACX,CAAC,IAAK,IAAK,MAuNE0P,cAnNb,SAAAA,EAAY5Q,GAAO,IAAAU,EAAA,OAAAsC,OAAAW,EAAA,EAAAX,CAAAjD,KAAA6Q,IACjBlQ,EAAAsC,OAAAY,EAAA,EAAAZ,CAAAjD,KAAAiD,OAAAa,EAAA,EAAAb,CAAA4N,GAAA9M,KAAA/D,KAAMC,KACDqF,MAAQ,CACXwL,GAAI,KACJC,GAAI,KACJC,eAAgB,KAChB/P,YAAa,KACbgQ,WAAY,KACZ5P,iBAAkB,GAEpBV,EAAKuM,YAAc,KACnBvM,EAAK0D,QAAUqF,WAAW/I,EAAK0D,QAAQhE,KAAb4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KAAyB,KACnDA,EAAKuQ,UAAYvQ,EAAKuQ,UAAU7Q,KAAf4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACjBA,EAAKT,iBAAmBS,EAAKT,iBAAiBG,KAAtB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACxBA,EAAKmC,YAAcnC,EAAKmC,YAAYzC,KAAjB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KACnBA,EAAKD,gBAAkBC,EAAKD,gBAAgBL,KAArB4C,OAAAuC,EAAA,EAAAvC,QAAAuC,EAAA,EAAAvC,CAAAtC,KAfNA,+EAkBHJ,GACd,IAAI8C,EAAIrD,KAAKC,MAAMmB,kBAAkB+P,QAAQ5Q,GAC7CP,KAAKoR,SAAS,CAAE/P,iBAAkBgC,sCAIlCrD,KAAKoR,SAAS,CAAEN,GAAIO,OAAOC,WAAYP,GAAIM,OAAOE,cAClD,IAAIP,EAAiBhR,KAAKwR,cAAcC,aACxCzR,KAAKoR,SAAS,CAAEJ,eAAgBA,IAC5BhR,KAAKkN,cAAalN,KAAKkN,YAAYwE,uBAAwB,4CAGhDC,GACf,IAAIC,EAAMD,EAAOE,WAAW,MAC5BD,EAAIF,uBAAwB,EAC5B1R,KAAKkN,YAAc0E,sCAGTtM,IACI,IAAVA,GACF+L,OAAOS,QAAQC,UAAU,KAAM,sBAAuB,UACtD/R,KAAKoR,SAAS,CAAEH,YAAY,MACT,IAAV3L,IACT+L,OAAOS,QAAQC,UAAU,KAAM,gBAAiBV,OAAOW,SAASC,UAChEjS,KAAKoR,SAAS,CAAEH,YAAY,2CAIlBhQ,GACZjB,KAAKoR,SAAS,CAAEnQ,YAAaA,iDAI7BjB,KAAKqE,UACLrE,KAAKkR,gDAIDG,OAAOW,SAASE,MAAiC,WAAzBb,OAAOW,SAASE,KAC1ClS,KAAKoR,SAAS,CAAEH,YAAY,IAE5BjR,KAAKoR,SAAS,CAAEH,YAAY,gDAK9BI,OAAOc,iBAAiB,SAAUnS,KAAKqE,SACvCgN,OAAOc,iBAAiB,WAAYnS,KAAKkR,0DAIzCG,OAAOe,oBAAoB,SAAUpS,KAAKqE,0CAGnC,IAsCHvD,EAAoBD,EAtCjBmF,EAAAhG,KAAAY,EAQHZ,KAAKC,MANPqJ,EAFK1I,EAEL0I,iBACA+I,EAHKzR,EAGLyR,sBACAC,EAJK1R,EAIL0R,2BACApR,EALKN,EAKLM,aACAE,EANKR,EAMLQ,kBACAqF,EAPK7F,EAOL6F,yBAPK8L,EAgBHvS,KAAKsF,MANPwL,EAVKyB,EAULzB,GACAC,EAXKwB,EAWLxB,GACAC,EAZKuB,EAYLvB,eACA/P,EAbKsR,EAaLtR,YACAgQ,EAdKsB,EAcLtB,WACA5P,EAfKkR,EAeLlR,iBAEE6L,EAAclN,KAAKkN,YAInBsF,EAAgB,CAClBhO,SAAU,WACVoL,KAAM,EACNC,IAAK,EACLtN,OAAQ,QACRmN,SAAU,OACVlN,WAAY,OACZd,QAAS,OACTC,cAAe,UAEb8Q,EAAa,CACfjO,SAAU,WACVjC,OAAQ,QACRC,WAAY,OACZkN,SAAU,UAIRgD,EAAY,GAChB,GAAI5B,EAAK,IACP4B,EAAY,GACZF,EAAavP,OAAA0P,EAAA,EAAA1P,CAAA,GACRuP,EADQ,CAEX7Q,cAAe,MACfW,MAAO,OACPuN,IAAK,OACLtN,OAAQ,OACRwN,OAAQ,IAEV0C,EAAa,CAAEnQ,MAAOwO,EAAIvO,OAAQwO,EAAKC,GACvClQ,EAhCgB,IAgCK4R,EAA0B,EAC/C7R,EAAsB,kBACjB,GAAIiQ,EAAK,KAAW,CACzB,IAAI8B,EAAS,KAAsB9B,EAAK,KAAO,IAA5B,IACnB4B,EAAY,IAAW5B,EAAK,KAAO,IAAlB,EAKjBhQ,GAJA0R,EAAavP,OAAA0P,EAAA,EAAA1P,CAAA,GACRuP,EADQ,CAEXlQ,MAAOsQ,KAE0BtQ,MACnCmQ,EAAUxP,OAAA0P,EAAA,EAAA1P,CAAA,GACLwP,EADK,CAERnQ,MAAOwO,EAAK8B,EACZhD,KAAMgD,EACNrQ,OAAQwO,IAEVlQ,EAAsB,gBAEtB2R,EAAavP,OAAA0P,EAAA,EAAA1P,CAAA,GACRuP,EADQ,CAEXlQ,MAAO,MAETmQ,EAAUxP,OAAA0P,EAAA,EAAA1P,CAAA,GACLwP,EADK,CAERnQ,MAAOwO,EAAK,IACZlB,KAAM,IACNrN,OAAQwO,IAEVjQ,EAAqB0R,EAAclQ,MACnCzB,EAAsB,WAGxB,IAAIE,EAhEc,IAgEP2R,EAEPG,EAAgB,CAClB3C,SAAUwC,EACVvC,WApEgB,KAuElB,OAAc,OAAPW,EACLxP,EAAAC,EAAAC,cAAA,OAAKC,MAAOoR,GACVvR,EAAAC,EAAAC,cAAA,OACEC,MAAO+Q,EACPnQ,IAAK,SAAAmP,GACHxL,EAAKwL,cAAgBA,IAGvBlQ,EAAAC,EAAAC,cAACsR,EAAD,CACEjS,oBAAqBA,EACrBC,mBAAoBA,EACpBC,KAAMA,EACNC,EAAGA,EACHG,YAAaA,EACbjB,iBAAkBF,KAAKE,iBACvBe,YAAaA,EACbC,aAAcA,EACd4B,YAAa9C,KAAK8C,YAClB1B,kBAAmBA,EACnBC,iBAAkBA,EAClBX,gBAAiBV,KAAKU,mBAG1BY,EAAAC,EAAAC,cAAA,OAAKC,MAAOgR,GACVnR,EAAAC,EAAAC,cAACuR,EAAD,CACEzQ,MAAOmQ,EAAWnQ,MAClBC,OAAQkQ,EAAWlQ,OACnB+G,iBAAkBA,EAClB+I,sBAAuBA,EACvBC,2BAA4BA,EAC5BpR,aAAcA,EACdC,YAAaA,EACb+L,YAAaA,EACbpM,mBAAoBA,EACpBsN,cAAepO,KAAKoO,cAAc/N,KAAKL,MACvCyG,yBAA0BA,EAC1BpF,iBAAkBA,KAGrB4P,EACC3P,EAAAC,EAAAC,cAACwR,EAAD,CAAOjS,KAAMA,EAAMC,EAAGA,EAAG8B,YAAa9C,KAAK8C,cACzC,MAGNxB,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEK,QAAS,SAAvB,4BA/MeiB,aCnBjB3B,EAAoB,CAAC,OAAQ,QAAS,qBACtCqF,EAA2B,CAC7B,mBACA,wBACA,8BA4EawM,cAxEb,SAAAA,EAAYhT,GAAO,IAAAU,EAAA,OAAAsC,OAAAW,EAAA,EAAAX,CAAAjD,KAAAiT,IACjBtS,EAAAsC,OAAAY,EAAA,EAAAZ,CAAAjD,KAAAiD,OAAAa,EAAA,EAAAb,CAAAgQ,GAAAlP,KAAA/D,KAAMC,KACDqF,MAAQ,CACXgE,iBAAkB,KAClBpI,aAAc,KACdoR,2BAA4B,MALb3R,+EASHuS,GACd,IAAI1J,EAAK0J,EAAWjR,IAAI,SAAA3B,GAAC,OAAI8H,KAAK6B,IAAI3J,EAAE,MACpCsJ,EAAKsJ,EAAWjR,IAAI,SAAA3B,GAAC,OAAI8H,KAAK6B,IAAI3J,EAAE,MACpCqJ,EAAQD,MAAMF,GACdM,EAAQJ,MAAME,GACdQ,EAAMhC,KAAKgC,IAAIT,EAAOG,GACtB7E,EAAQF,MAET+D,OAAO,EAAEsB,EAAKA,IACd5D,MAAM,EAAE,GAAI,KAEf,OADwB0M,EAAWjR,IAAI,SAAA3B,GAAC,MAAI,CAAC2E,EAAM3E,EAAE,IAAK2E,EAAM3E,EAAE,mDAIhD,IAAA0F,EAAAhG,KAClBmT,MAAK,GAAA1Q,OAAIa,iBAAJ,2BACF8P,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAA9J,GACJ,IAAIiK,EAAoBvN,EAAKwN,gBAAgBlK,GAC7CtD,EAAKoL,SAAS,CACZ9H,iBAAkBiK,MAGxBJ,MAAK,GAAA1Q,OAAIa,iBAAJ,qCACF8P,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAA9J,GACJ,IAAIiK,EAAoBvN,EAAKwN,gBAAgBlK,GAC7CmK,QAAQC,IAAI,UACZ1N,EAAKoL,SAAS,CACZkB,2BAA4BiB,MAGlCJ,MAAK,GAAA1Q,OAAIa,iBAAJ,gCACF8P,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAA9J,GACJ,IAAIiK,EAAoBvN,EAAKwN,gBAAgBlK,GAC7CtD,EAAKoL,SAAS,CACZiB,sBAAuBkB,MAG7BJ,MAAK,GAAA1Q,OAAIa,iBAAJ,uBACF8P,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAAlS,GAAY,OAChB8E,EAAKoL,SAAS,CACZlQ,aAAcA,uCAOpB,OADAuS,QAAQC,IAAI1T,KAAKsF,OACVtF,KAAKsF,MAAMgE,kBAAoBtJ,KAAKsF,MAAMpE,aAC/CI,EAAAC,EAAAC,cAACmS,EAAD1Q,OAAA2Q,OAAA,GACM5T,KAAKsF,MADX,CAEElE,kBAAmBA,EACnBqF,yBAA0BA,KAG5BnF,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEK,QAAS,SAAvB,0BApEaiB,aCFJ8Q,mLAJX,OAAOvS,EAAAC,EAAAC,cAACsS,EAAD,aAFO/Q,aCQEgR,QACW,cAA7B1C,OAAOW,SAASgC,UAEe,UAA7B3C,OAAOW,SAASgC,UAEhB3C,OAAOW,SAASgC,SAASC,MACvB,2DCZNC,IAAS9E,OAAO9N,EAAAC,EAAAC,cAAC2S,EAAD,MAASzQ,SAAS0Q,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMnB,KAAK,SAAAoB,GACjCA,EAAaC","file":"static/js/main.bf2ac46b.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nclass Sidebar extends Component {\n  componentDidMount() {\n    this.props.setSidebarCanvas(this.side_canvas)\n    this.handleSelectAlgorithm = this.handleSelectAlgorithm.bind(this)\n  }\n\n  handleSelectAlgorithm(e) {\n    let v = e.target.value\n    this.props.selectAlgorithm(v)\n  }\n\n  render() {\n    let {\n      sidebar_orientation,\n      sidebar_image_size,\n      grem,\n      p,\n      hover_index,\n      mnist_labels,\n      color_array,\n      algorithm_options,\n      algorithm_choice,\n    } = this.props\n\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'space-between',\n          flexGrow: 1,\n        }}\n      >\n        <div>\n          {' '}\n          <div\n            style={{\n              padding: grem / 2,\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n            }}\n          >\n            <div>Algorithm:</div>\n            <select\n              onChange={this.handleSelectAlgorithm}\n              value={algorithm_options[algorithm_choice]}\n            >\n              {algorithm_options.map((option, index) => (\n                <option key={option} value={option}>\n                  {option}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div\n            style={{\n              display: 'flex',\n              flexDirection:\n                sidebar_orientation === 'horizontal' ? 'row' : 'column',\n            }}\n          >\n            <div>\n              <canvas\n                ref={side_canvas => {\n                  this.side_canvas = side_canvas\n                }}\n                width={sidebar_image_size}\n                height={sidebar_image_size}\n              />\n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div\n                style={{\n                  background: hover_index\n                    ? `rgb(${color_array[mnist_labels[hover_index]].join(',')})`\n                    : 'transparent',\n                  color: hover_index ? '#000' : '#fff',\n                  padding: p(grem / 4, grem / 2),\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  transition: 'all 0.1s linear',\n                }}\n              >\n                <div>Label:</div>\n                {hover_index ? <div>{mnist_labels[hover_index]}</div> : null}\n              </div>\n              <div\n                style={{\n                  padding: p(grem / 4, grem / 2),\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                }}\n              >\n                Index:\n                {hover_index ? <div>{hover_index}</div> : null}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div style={{ padding: grem / 2 }}>\n          <div>\n            An interactive UMAP visualization of the MNIST data set.{' '}\n            <button\n              onClick={() => {\n                this.props.toggleAbout(true)\n              }}\n            >\n              About\n            </button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Sidebar\n","import React, { Component } from 'react'\nimport * as THREE from 'three'\nimport * as _ from 'lodash'\nimport * as d3 from 'd3'\nimport * as TWEEN from '@tweenjs/tween.js'\n\n// Constants for sprite sheets\nlet sprite_side = 73\nlet sprite_size = sprite_side * sprite_side\nlet sprite_number = 14\nlet sprite_image_size = 28\n// actual sprite size needs to be power of 2\nlet sprite_actual_size = 2048\n\nlet mnist_tile_string = 'mnist_tile_solid_'\nlet mnist_tile_locations = [...Array(sprite_number)].map(\n  (n, i) => `${process.env.PUBLIC_URL}/${mnist_tile_string}${i}.png`\n)\n\nlet mnist_images = mnist_tile_locations.map(src => {\n  let img = document.createElement('img')\n  img.src = src\n  return img\n})\n\nlet zoomScaler = input => {\n  let scale1 = d3\n    .scaleLinear()\n    .domain([20, 5])\n    .range([14, 28])\n    .clamp(true)\n  let scale2 = d3\n    .scaleLinear()\n    .domain([2, 0.1])\n    .range([28, 56])\n  if (input >= 5) {\n    return scale1(input)\n    // return 28\n  } else if (input <= 2) {\n    // return scale2(input)\n    return 28\n  } else {\n    return 28\n  }\n}\n\nclass Projection extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {}\n    this.init = this.init.bind(this)\n    this.addPoints = this.addPoints.bind(this)\n    this.handleResize = this.handleResize.bind(this)\n    this.setUpCamera = this.setUpCamera.bind(this)\n    this.animate = this.animate.bind(this)\n    this.getScaleFromZ = this.getScaleFromZ.bind(this)\n    this.getZFromScale = this.getZFromScale.bind(this)\n    this.changeEmbeddings = this.changeEmbeddings.bind(this)\n  }\n\n  changeEmbeddings(prev_choice, new_choice) {\n    // assumes mnist embeddings has been updated\n\n    let ranges = []\n    for (let i = 0; i < sprite_number; i++) {\n      let start = i * sprite_size\n      let end = (i + 1) * sprite_size\n      if (i === sprite_number - 1) end = sprite_number * sprite_size\n      ranges.push([start, end])\n    }\n\n    let embedding_chunks = ranges.map(range =>\n      this.props[this.props.algorithm_embedding_keys[new_choice]].slice(\n        range[0],\n        range[1]\n      )\n    )\n\n    for (let c = 0; c < sprite_number; c++) {\n      let echunk = embedding_chunks[c]\n\n      let points = this.scene.children[0].children[c]\n      let numVertices = echunk.length\n      let position = points.geometry.attributes.position.array\n      let target = new Float32Array(numVertices * 3)\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 3) {\n        let x = echunk[i][0]\n        let y = echunk[i][1]\n        let z = 0\n        target[index] = x\n        target[index + 1] = y\n        target[index + 2] = z\n      }\n\n      let tween = new TWEEN.Tween(position)\n        .to(target, 1000)\n        .easing(TWEEN.Easing.Linear.None)\n      tween.onUpdate(function() {\n        points.geometry.attributes.position = new THREE.BufferAttribute(\n          position,\n          3\n        )\n        points.geometry.attributes.position.needsUpdate = true // required after the first render\n      })\n      tween.start()\n    }\n  }\n\n  getZFromScale(scale) {\n    let rvFOV = THREE.Math.degToRad(this.camera.fov)\n    let scale_height = this.props.height / scale\n    let camera_z_position = scale_height / (2 * Math.tan(rvFOV / 2))\n    return camera_z_position\n  }\n\n  getScaleFromZ(camera_z_position) {\n    let rvFOV = THREE.Math.degToRad(this.camera.fov)\n    let half_fov_height = Math.tan(rvFOV / 2) * camera_z_position\n    let fov_height = half_fov_height * 2\n    let scale = this.props.height / fov_height\n    return scale\n  }\n\n  handleResize = (width, height) => {\n    this.camera.aspect = width / height\n    this.camera.updateProjectionMatrix()\n    this.renderer.setSize(width, height)\n    let current_scale = this.getScaleFromZ(this.camera.position.z)\n    let d3_x = -(this.camera.position.x * current_scale) + this.props.width / 2\n    let d3_y = this.camera.position.y * current_scale + this.props.height / 2\n    var resize_transform = d3.zoomIdentity\n      .translate(d3_x, d3_y)\n      .scale(current_scale)\n    let view = d3.select(this.mount)\n    this.d3_zoom.transform(view, resize_transform)\n  }\n\n  zoomHandler() {\n    let d3_transform = d3.event.transform\n\n    let scale = d3_transform.k\n    let x = -(d3_transform.x - this.props.width / 2) / scale\n    let y = (d3_transform.y - this.props.height / 2) / scale\n    let z = this.getZFromScale(scale)\n\n    this.camera.position.set(x, y, z)\n\n    // point size scales at end of zoom\n    let new_size = zoomScaler(z)\n    let point_group = this.scene.children[0].children\n    for (let c = 0; c < point_group.length; c++) {\n      point_group[c].material.uniforms.size.value = new_size\n    }\n  }\n\n  setUpCamera() {\n    let { width, height, mnist_embeddings } = this.props\n\n    let aspect = this.camera.aspect\n    let vFOV = this.camera.fov\n    let rvFOV = THREE.Math.degToRad(vFOV)\n\n    let xs = mnist_embeddings.map(e => e[0])\n    let min_x = _.min(xs)\n    let max_x = _.max(xs)\n    let ys = mnist_embeddings.map(e => e[1])\n    let min_y = _.min(ys)\n    let max_y = _.max(ys)\n    let data_width = max_x - min_x\n    let data_height = max_y - min_y\n    let data_aspect = data_width / data_height\n\n    let max_x_from_center = _.max([min_x, max_x].map(m => Math.abs(m)))\n    let max_y_from_center = _.max([min_y, max_y].map(m => Math.abs(m)))\n\n    let max_center = Math.max(max_x_from_center, max_y_from_center)\n\n    let camera_z_start\n    if (data_aspect > aspect) {\n      // console.log(\"width is limiter\");\n      // camera_z_start = max_x_from_center / Math.tan(rvFOV / 2) / aspect\n    } else {\n      // console.log(\"height is limiter\");\n      // camera_z_start = max_y_from_center / Math.tan(rvFOV / 2)\n    }\n\n    camera_z_start = max_center / Math.tan(rvFOV / 2)\n\n    let far = camera_z_start * 1.25\n    this.camera.far = far\n    this.camera.position.z = camera_z_start * 1.1\n\n    // set up zoom\n    this.d3_zoom = d3\n      .zoom()\n      .scaleExtent([this.getScaleFromZ(far - 1), this.getScaleFromZ(0.1)])\n      .on('zoom', this.zoomHandler.bind(this))\n\n    let view = d3.select(this.mount)\n    this.view = view\n    view.call(this.d3_zoom)\n    let initial_scale = this.getScaleFromZ(this.camera.position.z)\n    var initial_transform = d3.zoomIdentity\n      .translate(width / 2, height / 2)\n      .scale(initial_scale)\n    this.d3_zoom.transform(view, initial_transform)\n  }\n\n  addPoints() {\n    let { mnist_embeddings, mnist_labels, color_array } = this.props\n\n    // split embeddings and labels into chunks to match sprites\n    let ranges = []\n    for (let i = 0; i < sprite_number; i++) {\n      let start = i * sprite_size\n      let end = (i + 1) * sprite_size\n      if (i === sprite_number - 1) end = sprite_number * sprite_size\n      ranges.push([start, end])\n    }\n    let embedding_chunks = ranges.map(range =>\n      mnist_embeddings.slice(range[0], range[1])\n    )\n    let label_chunks = ranges.map(range =>\n      mnist_labels.slice(range[0], range[1])\n    )\n\n    // load the textures\n    let loader = new THREE.TextureLoader()\n    this.textures = mnist_tile_locations.map(l => {\n      let t = loader.load(l)\n      t.flipY = false\n      t.magFilter = THREE.NearestFilter\n      // t.minFilter = THREE.LinearMipMapLinearFilter;\n      return t\n    })\n\n    let point_group = new THREE.Group()\n    for (let c = 0; c < sprite_number; c++) {\n      let echunk = embedding_chunks[c]\n      let lchunk = label_chunks[c]\n\n      let vertices = []\n      for (let v = 0; v < echunk.length; v++) {\n        let embedding = echunk[v]\n        let vert = new THREE.Vector3(embedding[0], embedding[1], 0)\n        vertices[v] = vert\n      }\n\n      let geometry = new THREE.BufferGeometry()\n\n      let numVertices = vertices.length\n      let positions = new Float32Array(numVertices * 3)\n      let offsets = new Float32Array(numVertices * 2)\n      let colors = new Float32Array(numVertices * 3)\n      geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3))\n      geometry.addAttribute('offset', new THREE.BufferAttribute(offsets, 2))\n      geometry.addAttribute('color', new THREE.BufferAttribute(colors, 3))\n\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 3) {\n        let x = echunk[i][0]\n        let y = echunk[i][1]\n        let z = 0\n        positions[index] = x\n        positions[index + 1] = y\n        positions[index + 2] = z\n      }\n\n      // geometry.attributes.position.copyVector3sArray(vertices)\n\n      let texture_subsize = 1 / sprite_side\n\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 2) {\n        let x = ((i % sprite_side) * sprite_image_size) / sprite_actual_size\n        let y =\n          (Math.floor(i / sprite_side) * sprite_image_size) / sprite_actual_size\n        offsets[index] = x\n        offsets[index + 1] = y\n      }\n\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 3) {\n        let color = color_array[lchunk[i]]\n        colors[index] = color[0] / 255\n        colors[index + 1] = color[1] / 255\n        colors[index + 2] = color[2] / 255\n      }\n\n      // uniforms\n      let uniforms = {\n        texture: { value: this.textures[c] },\n        repeat: { value: new THREE.Vector2(texture_subsize, texture_subsize) },\n        size: { value: sprite_image_size },\n      }\n\n      let vertex_shader = `\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }`\n\n      let fragment_shader = `\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }`\n\n      // material\n      let material = new THREE.ShaderMaterial({\n        uniforms: uniforms,\n        vertexShader: vertex_shader,\n        fragmentShader: fragment_shader,\n      })\n\n      // point cloud\n      let point_cloud = new THREE.Points(geometry, material)\n      point_cloud.userData = { sprite_index: c }\n\n      point_group.add(point_cloud)\n    }\n\n    this.scene.add(point_group)\n  }\n\n  addBlankHighlightPoints() {\n    let hover_container = new THREE.Group()\n    this.scene.add(hover_container)\n\n    let vert = new THREE.Vector3(0, 0, 0)\n    let vertices = [vert]\n    let geometry = new THREE.BufferGeometry()\n    let numVertices = vertices.length\n    var positions = new Float32Array(numVertices * 3) // 3 coordinates per point\n    var offsets = new Float32Array(numVertices * 2) // 2 coordinates per point\n    geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3))\n    geometry.addAttribute('offset', new THREE.BufferAttribute(offsets, 2))\n\n    // all the attributes will be filled on hover\n    let texture_subsize = 1 / sprite_side\n\n    // uniforms\n    let uniforms = {\n      texture: { value: this.textures[0] },\n      repeat: { value: new THREE.Vector2(texture_subsize, texture_subsize) },\n      size: { value: 56.0 },\n    }\n\n    let vertex_shader = `\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }`\n\n    let fragment_shader = `\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          gl_FragColor = tex;\n        }`\n\n    // material\n    var material = new THREE.ShaderMaterial({\n      uniforms: uniforms,\n      vertexShader: vertex_shader,\n      fragmentShader: fragment_shader,\n    })\n\n    let point = new THREE.Points(geometry, material)\n    point.frustumCulled = false\n\n    this.scene.children[1].visible = false\n    this.scene.children[1].add(point)\n  }\n\n  highlightPoint(sprite_index, digit_index, full_index) {\n    let { algorithm_embedding_keys, algorithm_choice } = this.props\n\n    let point = this.scene.children[1].children[0]\n\n    let embedding = this.props[algorithm_embedding_keys[algorithm_choice]][\n      full_index\n    ]\n\n    let vert = new THREE.Vector3(embedding[0], embedding[1], 0)\n    let vertices = [vert]\n\n    var offsets = new Float32Array(2) // 2 coordinates per point\n\n    let x = ((digit_index % sprite_side) * 28) / 2048\n    let y = (Math.floor(digit_index / sprite_side) * 28) / 2048\n    offsets[0] = x\n    offsets[1] = y\n\n    point.geometry.attributes.position.copyVector3sArray(vertices)\n    point.geometry.attributes.position.needsUpdate = true // required after the first render\n    point.geometry.attributes.offset.array = offsets\n    point.geometry.attributes.offset.needsUpdate = true // required after the first render\n\n    // need to set attributes on geometry and uniforms on material\n    point.material.uniforms.texture.value = this.textures[sprite_index]\n  }\n\n  removeHighlights() {\n    let highlight_container = this.scene.children[1]\n    let highlights = highlight_container.children\n    highlight_container.remove(...highlights)\n  }\n\n  checkIntersects(mouse_position) {\n    let { width, height, sidebar_ctx, sidebar_image_size } = this.props\n\n    function mouseToThree([mouseX, mouseY]) {\n      return new THREE.Vector3(\n        (mouseX / width) * 2 - 1,\n        -(mouseY / height) * 2 + 1,\n        1\n      )\n    }\n\n    function sortIntersectsByDistanceToRay(intersects) {\n      return _.sortBy(intersects, 'distanceToRay')\n    }\n\n    let mouse_vector = mouseToThree(mouse_position)\n    this.raycaster.setFromCamera(mouse_vector, this.camera)\n    this.raycaster.params.Points.threshold = 0.25\n    let intersects = this.raycaster.intersectObjects(\n      this.scene.children[0].children\n    )\n    if (intersects[0]) {\n      let sorted_intersects = sortIntersectsByDistanceToRay(intersects)\n      let intersect = sorted_intersects[0]\n      let sprite_index = intersect.object.userData.sprite_index\n      let digit_index = intersect.index\n      let full_index = sprite_index * sprite_size + digit_index\n      this.props.setHoverIndex(full_index)\n      this.highlightPoint(sprite_index, digit_index, full_index)\n      this.scene.children[1].visible = true\n\n      sidebar_ctx.fillRect(0, 0, sidebar_image_size, sidebar_image_size)\n      sidebar_ctx.drawImage(\n        mnist_images[sprite_index],\n        // source rectangle\n        (digit_index % sprite_side) * sprite_image_size,\n        Math.floor(digit_index / sprite_side) * sprite_image_size,\n        sprite_image_size,\n        sprite_image_size,\n        // destination rectangle\n        0,\n        0,\n        sidebar_image_size,\n        sidebar_image_size\n      )\n    } else {\n      this.props.setHoverIndex(null)\n      this.scene.children[1].visible = false\n      sidebar_ctx.fillRect(0, 0, sidebar_image_size, sidebar_image_size)\n    }\n  }\n\n  handleMouse() {\n    let view = d3.select(this.renderer.domElement)\n\n    this.raycaster = new THREE.Raycaster()\n\n    view.on('mousemove', () => {\n      let [mouseX, mouseY] = d3.mouse(view.node())\n      let mouse_position = [mouseX, mouseY]\n      this.checkIntersects(mouse_position)\n    })\n  }\n\n  init() {\n    let { width, height } = this.props\n\n    this.scene = new THREE.Scene()\n\n    let vFOV = 75\n    let aspect = width / height\n    let near = 0.01\n    let far = 1000\n\n    this.camera = new THREE.PerspectiveCamera(vFOV, aspect, near, far)\n\n    this.renderer = new THREE.WebGLRenderer()\n    this.renderer.setClearColor(0x111111, 1)\n    this.renderer.setSize(width, height)\n    this.mount.appendChild(this.renderer.domElement)\n\n    this.addPoints()\n\n    this.addBlankHighlightPoints()\n\n    this.setUpCamera()\n\n    this.animate()\n\n    this.handleMouse()\n  }\n\n  animate() {\n    requestAnimationFrame(this.animate)\n    TWEEN.update()\n    this.renderer.render(this.scene, this.camera)\n  }\n\n  componentDidMount() {\n    this.init()\n  }\n\n  componentDidUpdate(prevProps) {\n    let { width, height } = this.props\n    if (width !== prevProps.width || height !== prevProps.height) {\n      this.handleResize(width, height)\n    }\n    if (prevProps.algorithm_choice !== this.props.algorithm_choice) {\n      this.changeEmbeddings(\n        prevProps.algorithm_choice,\n        this.props.algorithm_choice\n      )\n    }\n  }\n\n  componentWillUnmount() {\n    this.mount.removeChild(this.renderer.domElement)\n  }\n\n  render() {\n    let { width, height } = this.props\n    return (\n      <div\n        style={{ width: width, height: height, overflow: 'hidden' }}\n        ref={mount => {\n          this.mount = mount\n        }}\n      />\n    )\n  }\n}\n\nexport default Projection\n","import React, { Component } from 'react'\nimport Markdown from 'react-remarkable'\nimport { about_text } from './Content'\n\nclass About extends Component {\n  render() {\n    let { grem, p } = this.props\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          left: 0,\n          top: 0,\n          right: 0,\n          bottom: 0,\n          background: '#222',\n          color: '#fff',\n          paddingTop: grem * 2,\n          overflowY: 'auto',\n          fontSize: 16,\n          lineHeight: 1.5,\n        }}\n      >\n        <div\n          style={{\n            background: '#333',\n            position: 'fixed',\n            left: 0,\n            top: 0,\n            right: 0,\n            padding: grem / 2,\n          }}\n        >\n          About\n          <button\n            onClick={() => {\n              this.props.toggleAbout(false)\n            }}\n            className=\"hover-555\"\n            style={{\n              position: 'absolute',\n              right: 0,\n              top: 0,\n              height: grem * 2,\n              width: grem * 2,\n              padding: grem / 2,\n              textAlign: 'center',\n              cursor: 'pointer',\n              textDecoration: 'none',\n            }}\n          >\n            &times;\n          </button>\n        </div>\n        <div\n          style={{\n            maxWidth: grem * 30,\n            margin: '0 auto',\n            padding: grem / 2,\n            color: '#fff',\n          }}\n        >\n          <Markdown>{about_text}</Markdown>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default About\n","export let about_text = `\n# About UMAP explorer\n\nThis is an interactive visualization that uses the [UMAP algorithm](https://github.com/lmcinnes/umap) to cluster hand-drawn digits from the [MNIST dataset](http://yann.lecun.com/exdb/mnist/). I'm sharing it as an example of how to render tens of thousands of images mapped to data points using the [three.js](https://threejs.org/) library. The code is available [on github](https://github.com/GrantCuster/umap-explorer) and can be adapted or used as a reference for doing similar visualizations with different datasets or algorithms. If you do use it or have questions please let me know at [grantcuster@gmail.com](mailto:grantcuster+umap@gmail.com) or [on Twitter](https://twitter.com/grantcuster).\n\n## Updates\n\n- 2019-01-21: Added T-SNE and UMAP \\`min_dist=0.8\\` algorithm options. \\`min_dist\\` setting based on this [Twitter exchange](https://twitter.com/kcimc/status/930149461078265856). Interpolation is done using [TWEEN.js](https://github.com/tweenjs/tween.js/) and updating the position attribute of the points.\n\n## About UMAP\n\nThe UMAP algorithm is responsible for the clustering of the images. The coordinates for each data point in the visualization are from the [UMAP MNIST example notebook](https://github.com/lmcinnes/umap_paper_notebooks/blob/master/UMAP%20MNIST.ipynb). Check out [the UMAP guides and documentation](https://umap-learn.readthedocs.io/en/latest/) to learn more about how UMAP works.\n\n## About the visualization code\n\nThis code was developed as part of a prototype for [Cloudera Fast Forward Labs](https://www.cloudera.com/products/fast-forward-labs-research.html). I had worked through how to use three.js for 2D data visualization in a previous project. If you're interested in how to set-up the three.js camera and get it working with [d3-zoom](https://github.com/d3/d3-zoom) I recommend [the notebook I wrote about that project](https://beta.observablehq.com/@grantcuster/using-three-js-for-2d-data-visualization).\n\n## Rendering the images\n\nInstead of just the dots of my previous project, I wanted to render each data point in this one as the image itself. A lot of what you want to see when you look at a clustering algorithm is how it puts together its clusters. Displaying the images themselves (rather than showing one-at-a-time on hover) gives a much better view into how the algorithm is working. I knew a bit about how textures worked in three.js from the last project, and I had some experience with sprite sheets from trying to optimize website image loading. I had a vague idea putting the images together in a sprite sheet (in this context known as a [texture atlas](https://en.wikipedia.org/wiki/Texture_atlas)) and then cropping and offsetting could work to render all 70,000 MNIST images, but I didn't know what the real mechanics of that would look like.\n\nIt took me a while to get there, but the key turned out to be this [WestLangley answer](https://stackoverflow.com/questions/25335967/texture-atlas-offset-repeat-works-for-meshes-but-is-ignored-for-point-system-par/25372202#25372202) and the [accompanying jsfiddle](http://jsfiddle.net/myy7x4zd/10/), which shows how to combine the points geometry with a texture atlas to render different images across the different points. I used that example as the starting point for this visualization. I learned a lot more about uniforms, attributes, and shaders as I made tweaks to get the results I wanted, but that example is the core of the image rendering.\n\n### Generating the images\n\n![](./mnist_tile_solid_0.png)\n\n_A texture atlas of one chunk of the MNIST dataset._\n\nAnother big help in making this was [Douglas Duhaime's post on using three.js to visualize TSNE maps](https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html). Finding Douglas's post and project reassured me that I was on the right path. It also provided lots of information about texture atlases. Including the info that for some devices, 2048x2048 is the largest size allowed.\n\nDouglas shows how to use ImageMagick to create texture atlases. For our project I wanted to generate them in python. The prototype will have several different datasets. My co-workers are already doing their machine learning stuff with those datasets in python, so if we code out a pipeline in python to generate both the embeddings for the visualization and the texture atlases we should be able to switch out different datasets relatively easily. We put together this visualization of the MNIST dataset to make sure that approach would work on a dataset we knew well (we didn't want to have to debug the visualization rendering and the dataset and models all at the same time). I included the [iPython notebook code for generating the images in the github repository](https://github.com/GrantCuster/umap-explorer). I'm new to python so it's not pretty, but it worked.\n\n### Gotchas: transparency, image size, and highlighting\n\nIn this visualization, the transparency of the digits comes from discarding color data below a threshold of 0.5. As far as I can tell, you can't do gradual transparency with this approach. You can see the effect of this when you're zoomed out â€“ the darker pixels within the clusters are ones that were above the threshold but not pure white. I don't mind the effect so much here. I was excited I could get what transparency I did. But it might be more of an issue for other datasets. For many image datasets you wouldn't want transparency at all. I am curious how this visualization would feel with non-transparent images.\n\nI think for non-transparent images you might want to adjust the size of the sprites even more. That gets into one of the biggest caveats about using three.js (and specifically the points object) for this type of visualization. By default the image data point is the same size no matter your zoom level (it doesn't get bigger as you get closer as an object would in real life). This can be a benefit, it lets you see more of the local structure as you zoom in. But you probably don't want the points to stay exactly the same size. What you can do is adjust the size of the points as you zoom by setting the uniform. As I understand it, a uniform isn't very expensive to update so you can do it a bunch of times on zoom. For this visualization, I set my own custom zoom scaler using d3-scale, which enlarges the size of the points at certain specified intervals. If I had more time I would definitely dial in the feel of this a bit more, but I think I got a relatively functional version in.\n\nFor highlighting I again used an approach from my past project. Using three.js's raycaster functionality to determine which point the mouse is over. To create the enlarged hover sprite I actually use a different point object with very similar shader code. There's probably a cleaner way to do this but it works for now.\n\n### Things I'd like to see (let me know if you do them)\n\n- I'd love to see what you could do by switching aprite sheets for different zoom levels. If you used different resolution sprites for different zoom levels you might get better performance. It could also be interesting to switch to something more abstract (like a circle sprite) when you're zoomed out and then switch over to the images only when you're zoomed in enough that they're useful.\n- Different scaling of points on zoom. Like I said, I don't think I nailed this part. I'd love to see someone take a more rigorous approach to it.\n- (DONE 2019-01-21) Transitions between algorithms. [Kyle McDonald made some GIFs of transitioning between UMAP and T-SNE](https://twitter.com/kcimc/status/930348969275691008). The way the shaders are set-up, I can kind of make out how you could do this (switch the position attributes, interpolate with something like tween.js), and it has the potential to look really slick.\n- Try it on the fashion MNIST dataset. [UMAP example here.](https://umap-learn.readthedocs.io/en/latest/supervised.html)\n- Port the visualization from three.js to [REGL.js](https://peterbeshai.com/beautifully-animate-points-with-webgl-and-regl.html).\n- Constraining zoom and pan so you can't scroll the visualization off-screen. I tried this a bit but ended up scoping it out of this version. If I cleaned up the code for wiring d3-zoom to three.js's camera this would probably be easier.\n- Make this a general framework for visualization. Easy, right? I think the core of this could be a really good approach for visualizing lots of datasets and how machine learning is viewing them. Making it friendly and handling all the edge cases would be a big undertaking though.\n\n### The code\n\nThe code is viewable [on github](https://github.com/GrantCuster/umap-explorer). Let me know if you have any questions and if you find it useful.\n\nâ€“ Grant`\n","import React, { Component } from 'react'\nimport Sidebar from './Sidebar'\nimport Projection from './Projection'\nimport About from './About'\nimport * as _ from 'lodash'\n\n// padding constructor\nfunction p(tb, lr) {\n  return `${tb}px ${lr}px`\n}\n\nlet color_array = [\n  [141, 211, 199],\n  [255, 255, 179],\n  [190, 186, 218],\n  [251, 128, 114],\n  [128, 177, 211],\n  [253, 180, 98],\n  [179, 222, 105],\n  [252, 205, 229],\n  [188, 128, 189],\n  [204, 235, 197],\n]\n\nclass Layout extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      ww: null,\n      wh: null,\n      sidebar_height: null,\n      hover_index: null,\n      show_about: null,\n      algorithm_choice: 0,\n    }\n    this.sidebar_ctx = null\n    this.setSize = _.debounce(this.setSize.bind(this), 200)\n    this.checkHash = this.checkHash.bind(this)\n    this.setSidebarCanvas = this.setSidebarCanvas.bind(this)\n    this.toggleAbout = this.toggleAbout.bind(this)\n    this.selectAlgorithm = this.selectAlgorithm.bind(this)\n  }\n\n  selectAlgorithm(v) {\n    let i = this.props.algorithm_options.indexOf(v)\n    this.setState({ algorithm_choice: i })\n  }\n\n  setSize() {\n    this.setState({ ww: window.innerWidth, wh: window.innerHeight })\n    let sidebar_height = this.sidebar_mount.offsetHeight\n    this.setState({ sidebar_height: sidebar_height })\n    if (this.sidebar_ctx) this.sidebar_ctx.imageSmoothingEnabled = false\n  }\n\n  setSidebarCanvas(canvas) {\n    let ctx = canvas.getContext('2d')\n    ctx.imageSmoothingEnabled = false\n    this.sidebar_ctx = ctx\n  }\n\n  toggleAbout(state) {\n    if (state === true) {\n      window.history.pushState(null, 'About UMAP Explorer', '#about')\n      this.setState({ show_about: true })\n    } else if (state === false) {\n      window.history.pushState(null, 'UMAP Explorer', window.location.pathname)\n      this.setState({ show_about: false })\n    }\n  }\n\n  setHoverIndex(hover_index) {\n    this.setState({ hover_index: hover_index })\n  }\n\n  componentWillMount() {\n    this.setSize()\n    this.checkHash()\n  }\n\n  checkHash() {\n    if (window.location.hash && window.location.hash === '#about') {\n      this.setState({ show_about: true })\n    } else {\n      this.setState({ show_about: false })\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.setSize)\n    window.addEventListener('popstate', this.checkHash)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.setSize)\n  }\n\n  render() {\n    let {\n      mnist_embeddings,\n      tsne_mnist_embeddings,\n      md08_umap_mnist_embeddings,\n      mnist_labels,\n      algorithm_options,\n      algorithm_embedding_keys,\n    } = this.props\n    let {\n      ww,\n      wh,\n      sidebar_height,\n      hover_index,\n      show_about,\n      algorithm_choice,\n    } = this.state\n    let sidebar_ctx = this.sidebar_ctx\n\n    let line_height = 1.5\n\n    let sidebar_style = {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      height: '100vh',\n      overflow: 'auto',\n      background: '#222',\n      display: 'flex',\n      flexDirection: 'column',\n    }\n    let main_style = {\n      position: 'relative',\n      height: '100vh',\n      background: '#111',\n      overflow: 'hidden',\n    }\n\n    let sidebar_image_size, sidebar_orientation\n    let font_size = 16\n    if (ww < 800) {\n      font_size = 14\n      sidebar_style = {\n        ...sidebar_style,\n        flexDirection: 'row',\n        width: '100%',\n        top: 'auto',\n        height: 'auto',\n        bottom: 0,\n      }\n      main_style = { width: ww, height: wh - sidebar_height }\n      sidebar_image_size = font_size * line_height * 3\n      sidebar_orientation = 'horizontal'\n    } else if (ww < 800 + 600) {\n      let scaler = 200 + (300 - 200) * ((ww - 800) / 600)\n      font_size = 14 + 2 * ((ww - 800) / 600)\n      sidebar_style = {\n        ...sidebar_style,\n        width: scaler,\n      }\n      sidebar_image_size = sidebar_style.width\n      main_style = {\n        ...main_style,\n        width: ww - scaler,\n        left: scaler,\n        height: wh,\n      }\n      sidebar_orientation = 'vertical'\n    } else {\n      sidebar_style = {\n        ...sidebar_style,\n        width: 300,\n      }\n      main_style = {\n        ...main_style,\n        width: ww - 300,\n        left: 300,\n        height: wh,\n      }\n      sidebar_image_size = sidebar_style.width\n      sidebar_orientation = 'vertical'\n    }\n\n    let grem = font_size * line_height\n\n    let general_style = {\n      fontSize: font_size,\n      lineHeight: line_height,\n    }\n\n    return ww !== null ? (\n      <div style={general_style}>\n        <div\n          style={sidebar_style}\n          ref={sidebar_mount => {\n            this.sidebar_mount = sidebar_mount\n          }}\n        >\n          <Sidebar\n            sidebar_orientation={sidebar_orientation}\n            sidebar_image_size={sidebar_image_size}\n            grem={grem}\n            p={p}\n            color_array={color_array}\n            setSidebarCanvas={this.setSidebarCanvas}\n            hover_index={hover_index}\n            mnist_labels={mnist_labels}\n            toggleAbout={this.toggleAbout}\n            algorithm_options={algorithm_options}\n            algorithm_choice={algorithm_choice}\n            selectAlgorithm={this.selectAlgorithm}\n          />\n        </div>\n        <div style={main_style}>\n          <Projection\n            width={main_style.width}\n            height={main_style.height}\n            mnist_embeddings={mnist_embeddings}\n            tsne_mnist_embeddings={tsne_mnist_embeddings}\n            md08_umap_mnist_embeddings={md08_umap_mnist_embeddings}\n            mnist_labels={mnist_labels}\n            color_array={color_array}\n            sidebar_ctx={sidebar_ctx}\n            sidebar_image_size={sidebar_image_size}\n            setHoverIndex={this.setHoverIndex.bind(this)}\n            algorithm_embedding_keys={algorithm_embedding_keys}\n            algorithm_choice={algorithm_choice}\n          />\n        </div>\n        {show_about ? (\n          <About grem={grem} p={p} toggleAbout={this.toggleAbout} />\n        ) : null}\n      </div>\n    ) : (\n      <div style={{ padding: '1rem' }}>Loading layout...</div>\n    )\n  }\n}\n\nexport default Layout\n","import React, { Component } from 'react'\nimport Layout from './Layout'\nimport * as _ from 'lodash'\nimport * as d3 from 'd3'\n\nlet algorithm_options = ['UMAP', 'T-SNE', 'UMAP min_dist=0.8']\nlet algorithm_embedding_keys = [\n  'mnist_embeddings',\n  'tsne_mnist_embeddings',\n  'md08_umap_mnist_embeddings',\n]\n\nclass Data extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      mnist_embeddings: null,\n      mnist_labels: null,\n      md08_umap_mnist_embeddings: null,\n    }\n  }\n\n  scaleEmbeddings(embeddings) {\n    let xs = embeddings.map(e => Math.abs(e[0]))\n    let ys = embeddings.map(e => Math.abs(e[1]))\n    let max_x = _.max(xs)\n    let max_y = _.max(ys)\n    let max = Math.max(max_x, max_y)\n    let scale = d3\n      .scaleLinear()\n      .domain([-max, max])\n      .range([-20, 20])\n    let scaled_embeddings = embeddings.map(e => [scale(e[0]), scale(e[1])])\n    return scaled_embeddings\n  }\n\n  componentDidMount() {\n    fetch(`${process.env.PUBLIC_URL}/mnist_embeddings.json`)\n      .then(response => response.json())\n      .then(mnist_embeddings => {\n        let scaled_embeddings = this.scaleEmbeddings(mnist_embeddings)\n        this.setState({\n          mnist_embeddings: scaled_embeddings,\n        })\n      })\n    fetch(`${process.env.PUBLIC_URL}/md08_umap_mnist_embeddings.json`)\n      .then(response => response.json())\n      .then(mnist_embeddings => {\n        let scaled_embeddings = this.scaleEmbeddings(mnist_embeddings)\n        console.log('got em')\n        this.setState({\n          md08_umap_mnist_embeddings: scaled_embeddings,\n        })\n      })\n    fetch(`${process.env.PUBLIC_URL}/tsne_mnist_embeddings.json`)\n      .then(response => response.json())\n      .then(mnist_embeddings => {\n        let scaled_embeddings = this.scaleEmbeddings(mnist_embeddings)\n        this.setState({\n          tsne_mnist_embeddings: scaled_embeddings,\n        })\n      })\n    fetch(`${process.env.PUBLIC_URL}/mnist_labels.json`)\n      .then(response => response.json())\n      .then(mnist_labels =>\n        this.setState({\n          mnist_labels: mnist_labels,\n        })\n      )\n  }\n\n  render() {\n    console.log(this.state)\n    return this.state.mnist_embeddings && this.state.mnist_labels ? (\n      <Layout\n        {...this.state}\n        algorithm_options={algorithm_options}\n        algorithm_embedding_keys={algorithm_embedding_keys}\n      />\n    ) : (\n      <div style={{ padding: '1rem' }}>Loading data...</div>\n    )\n  }\n}\n\nexport default Data\n","import React, { Component } from 'react'\nimport './App.css'\nimport Data from './Data'\n\nclass App extends Component {\n  render() {\n    return <Data />\n  }\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}